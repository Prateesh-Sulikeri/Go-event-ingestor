<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Go Event Ingestor Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script defer src="/static/app.js"></script>
<link rel="stylesheet" href="/static/style.css">
</head>

<body>

<header class="header">
  <div>
    <h1>Go Event Ingestor</h1>
    <p class="subtitle">Production-grade event ingestion with rate-limiting and real-time visualization</p>
  </div>
</header>

<main class="grid-layout">

  <!-- LEFT PANEL -->
  <section class="panel metrics">
    <h3>Total Events</h3>
    <div id="total" class="value">0</div>

    <div class="project-details">
      <h4>What This Project Demonstrates</h4>
      <ul>
        <li>High-throughput event ingestion API in Go (Gin)</li>
        <li>Redis token-bucket rate limiting (Lua script enforced)</li>
        <li>PostgreSQL-backed event persistence</li>
        <li>JWT-secured, multi-client ingestion flows</li>
        <li>Shell-based load generation traffic patterns</li>
        <li>Real-time telemetry dashboard powered by Flask + Chart.js</li>
      </ul>

      <hr class="divider">

      <h4>Architecture Stack</h4>
      <p class="arch-blurb">
        <strong>Client</strong> → JWT → <strong>Go API</strong> → Rate Limit via <strong>Redis</strong> → Insert to <strong>PostgreSQL</strong><br>
        Dashboard fetches metrics → <strong>Chart.js</strong> for real-time visualization
      </p>
    </div>

    <button class="danger" onclick="clearDB()">Clear DB</button>
  </section>

  <!-- CENTER PANEL -->
  <section class="panel controls">
    <h3>Traffic Controller</h3>

    <div class="control-block">
      <label>Steady Load (req/sec)</label>
      <input type="number" id="steady_rps" value="5" min="1">
      <button onclick="customSteady()">Start</button>
      <small>Constant load. Increase RPS to observe when the rate limit stabilizes throughput.</small>
    </div>

    <div class="control-block">
      <label>Burst Load (N events)</label>
      <input type="number" id="burst_count" value="200" min="1">
      <button onclick="customBurst()">Burst</button>
      <small>Injects many events at once → tests limiter response.</small>
    </div>

    <div class="control-block">
      <label>Wave Load (min → max RPS)</label>
      <div class="row">
        <input type="number" id="wave_min" value="1" min="0">
        <input type="number" id="wave_max" value="20" min="1">
      </div>
      <button onclick="customWave()">Start Wave</button>
      <small>Oscillates throughput like real-world peak/off-peak usage.</small>
    </div>

    <button class="stop" onclick="triggerStop()">Stop</button>
    <p id="status" class="status"></p>
  </section>

  <!-- RIGHT PANEL -->
  <section class="panel chart">
    <h3>Events per Minute (last 10)</h3>
    <canvas id="eventsChart"></canvas>
    <p class="chart-expectation">
      Expected Behavior → Steady: Climb | Burst: Spike | Wave: Oscillation
    </p>
  </section>

</main>

</body>
</html>
